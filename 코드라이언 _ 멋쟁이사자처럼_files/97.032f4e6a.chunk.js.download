(this["webpackJsonpcodelion-front"]=this["webpackJsonpcodelion-front"]||[]).push([[97],{1951:function(e,t,r){e.exports=r.p+"static/media/img-lock-icon.be4ca38d.svg"},2207:function(e,t,r){"use strict";r.r(t);var a=r(10),n=r.n(a),c=r(20),o=r(3),i=r(246),s=r(0),u=r.n(s),l=r(61),d=r(594),p=r(12),m=r(247),T=r(1950),S=r.n(T),O=r(599),f=r.n(O),w=r(162),E=r.n(w),h=r(1951),b=r.n(h),P=r(30);t.default=Object(l.b)((function(e){var t=e.common.apollo.client,r=e.cert;return{client:t,certData:r.certData,isCertCompleted:r.isCertCompleted,authBasic:e.auth.authBasic}}),(function(e){var t=e.cert;return{updateCertStepLog:t.updateCertStepLog,completedCert:t.completedCert,toggleModalCert:t.toggleModalCert,updateCertOtpLog:t.updateCertOtpLog,updateSignup:t.updateSignup}}))((function(e){var t=e.show,r=e.onHide,a=e.certData,l=e.updateCertStepLog,T=e.completedCert,O=e.onIntervalStart,w=e.isCertCompleted,h=e.authBasic,g=e.toggleModalCert,C=e.updateCertOtpLog,v=e.updateSignup,y=Object(s.useRef)(""),_=Object(s.useRef)(""),j=Object(s.useRef)(""),x=Object(s.useRef)(""),A=Object(s.useRef)(""),D=Object(s.useRef)(0),R=Object(s.useRef)(p.a),I=Object(s.useRef)(Object(p.l)().substring(0,10)),N=Object(s.useRef)(0),L=Object(s.useRef)(""),G=Object(s.useRef)(""),k=Object(s.useRef)(),K=Object(s.useState)({focus:{email:!1,title:!1,content:!1,ticketType:""},otpVal:"",AGTID:p.a,USRID:"",SESSIONID:Object(p.l)().substring(0,10),OTPTYPE:"102",isLoading:!0,CLASS_AGENT_PK:"",CLASS_STEP_GID:"",COURSE_AGENT_PK:"",CLASS_TME:1,OTP_STATUS:""}),U=Object(i.a)(K,2),F=U[0],M=U[1],V=function(){try{S.a.ajax({type:"POST",url:"https://fds.hrdkorea.or.kr/fdsService/hrdOTP/JSP/clientService/chkOtpDeviceStatus.jsp",crossDomain:!0,timeout:5e3,data:{AGTID:R.current,USRID:y.current},dataType:"xml",success:function(e){var t=S()(e).find("ConnStatus").text(),r=S()(e).find("OtpStatus").text();S()(e).find("ErrCnt").text(),S()(e).find("Remark").text();console.log("status::",t,r),"101"===t&&(M(Object(o.a)(Object(o.a)({},F),{},{OTP_STATUS:r})),_.current=r,"101"===r||"103"===r?window.ExecuteOTP():"102"===r&&(C({otpStatus:"102",stepGid:x.current}),console.log("OTP 5\ud68c \uc624\ub958!!")))},error:function(e,t,r){}})}catch(e){}};Object(c.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.v4();case 2:L.current=e.sent;case 3:case"end":return e.stop()}}),e)})))(),Object(s.useEffect)((function(){var e=a.USRID,r=a.CLASS_AGENT_PK,n=a.CLASS_TME;if(e&&t&&h){var c=h.organization,i=c.courseAgentPk,s=c.classAgentPk;M(Object(o.a)(Object(o.a)({},F),{},{USRID:e,CLASS_AGENT_PK:i,CLASS_STEP_GID:r,COURSE_AGENT_PK:s,CLASS_TME:n})),x.current=r,j.current=i,A.current=s,D.current=n,y.current=e,setTimeout((function(){M(Object(o.a)(Object(o.a)({},F),{},{isLoading:!1,otpVal:""})),k.current="",window.hrdFrame.loadHrdFrame(!0)}),1500)}}),[a,h,t]);window.certData=function(e){var t=E()().format("YYYY-MM-DD HH:mm:SS"),r=JSON.parse(e),a=(r.imp_uid,r.merchant_uid),n=r.pg_tid,c=r.birthday,i=r.carrier,s=r.certified,u=r.foreigner,l=(r.gender,r.name),d=r.phone;if(s){try{S.a.ajax({type:"POST",url:"https://fds.hrdkorea.or.kr/fdsService/hrdOTP/JSP/clientService/regiPhoneAuthLog.jsp",crossDomain:!0,timeout:5e3,data:{AGTID:R.current,USRID:y.current,m_Ret:"T",m_retCD:a,m_trnID:n,m_trnDT:t},dataType:"xml",success:function(e){console.log(e),"101"==S()(e).find("RetVal").text()?(M(Object(o.a)(Object(o.a)({},F),{},{OTP_STATUS:"101"})),_.current="101",C({otpStatus:"101",stepGid:x.current}),window.ExecuteOTP(),console.log("OTP \uc624\ub958 \ud574\uc81c!!")):alert("OTP \ucd08\uae30\ud654\uc5d0 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4!!")},error:function(e,t,r){alert(r)}})}catch(p){alert(p)}v({birthday:c,carrier:i,isKorean:!u,isSelfCert:!0,name:l,phone:d})}else alert("OTP \ucd08\uae30\ud654\uc5d0 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4!!")};return window.OtpDoneListener=function(e){console.log("OtpDoneListener"+e),"101"!==e&&alert("HRD System Load Error !! "+e)},window.loadAPIReceiver=function(e,t){console.log("loadAPIReceiver"+e+t),"101"===e&&(V(),window.hrdFrame.loadOTP(R.current,y.current,I.current,"102".current))},window.loadOtpReceiver=function(e,t){console.log("loadOtpReceiver"+e+t),"102"===e&&"OTP \uc0ac\uc6a9\uc790 \uc815\ubcf4\uc870\ud68c \uc624\ub958"===t&&V()},window.ExecuteOTP=function(){try{window.hrdFrame.loadOTP(R.current,y.current,I.current,"102".current)}catch(e){alert("ExecuteError:",e)}},window.showKeypad=function(e){window.hrdFrame.loadKeyPad(e,"Frame","400px")},window.loadKeypadReceiver=function(e,t){},window.hideKeypad=function(){window.hrdFrame.hideKeyPad()},u.a.createElement(d.a,{dialogClassName:"certification-modal",show:t,size:"xl",backdrop:"static",onHide:r,centered:!0,onExited:function(){h.stats.isCertified||w||g(!0)}},u.a.createElement(d.a.Header,null,u.a.createElement("h1",{className:"text-center m-0 w-100"},u.a.createElement("div",null,u.a.createElement("img",{src:b.a,alt:"",width:"70",height:"70"})),u.a.createElement("div",null,"\ud55c\uad6d\uc0b0\uc5c5\uc778\ub825\uacf5\ub2e8\uc5d0\uc11c \uc81c\uacf5\ud558\ub294 \ud504\ub85c\uadf8\ub7a8\uc73c\ub85c \ubd80\uc815\ubc29\uc9c0\ub97c \uc704\ud574\uc11c \ubcf4\uc548\uc808\ucc28\ub97c \uac70\uce58\uace0 \uc788\uc2b5\ub2c8\ub2e4."),"102"===F.OTP_STATUS?u.a.createElement(u.a.Fragment,null,u.a.createElement("div",null,"OTP \ube44\ubc00\ubc88\ud638\uac00 5\ud68c \uc5f0\uc18d\uc624\ub958\ub85c \uc0ac\uc6a9\uc774 \uc81c\ud55c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),u.a.createElement("div",null,"\uc544\ub798 [OTP \uc0c1\ud0dc\ucf54\ub4dc \ucd08\uae30\ud654] \ubc84\ud2bc\uc744 \ub20c\ub7ec \ub2e4\uc2dc \uc815\uc0c1 \uc0c1\ud0dc\ub85c \uac31\uc2e0\ucc98\ub9ac \uc9c4\ud589\ud574 \uc8fc\uc138\uc694.")):u.a.createElement(u.a.Fragment,null,u.a.createElement("div",null,"\ud074\ub77c\uc6b0\ub4dc OTP \ub4f1\ub85d\ud6c4 \ud558\ub2e8\uc5d0 \ub098\ud0c0\ub098\ub294 \uc22b\uc790\ub97c \ud0a4\ud328\ub4dc\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc785\ub825\ud6c4 [\uc778\uc99d\ud558\uae30] \ubc84\ud2bc\uc744\ub20c\ub7ec\uc8fc\uc138\uc694."),u.a.createElement("div",null,"OTP \ube44\ubc00\ubc88\ud638\uac00 \ubcf4\uc77c\ub54c\uae4c\uc9c0 \uc7a0\uc2dc\ub9cc \uae30\ub2e4\ub824 \uc8fc\uc138\uc694.")))),u.a.createElement(d.a.Body,{className:"p-0 text-center"},"102"===F.OTP_STATUS?u.a.createElement("div",{className:"cert-body-sub w-100 text-center"},u.a.createElement("input",{type:"button",value:"OTP \uc0c1\ud0dc\ucf54\ub4dc \ucd08\uae30\ud654",size:"sm",className:"button",onClick:function(){!function(e){e.certType,e.order,e.stepGid,e.userIp,e.timestamp;var t=E()().format("YYYY-MM-DD HH:mm:SS");console.log(t),window.open("/phone-cert-popup","certPopup","width=810, height=700, resizable=0, scrollbars=no, status=0, titlebar=0, toolbar=0, left=300, top=200")}({certType:parseInt(N.current),order:parseInt(D.current),stepGid:x.current,userIp:L.current})}})):u.a.createElement("div",{className:"cert-body-sub w-100 text-center"},u.a.createElement("input",{type:"password",placeholder:"Enter Key",ref:k,id:"otpVal",className:"textbox",value:F.otpVal,onClick:function(){window.showKeypad(k.current)},onChange:function(e){M(Object(o.a)(Object(o.a)({},F),{},{otpVal:e.target.value}))}})," ",u.a.createElement("input",{type:"button",value:"\uc778\uc99d\ud558\uae30",size:"sm",className:"button",onClick:function(){!function(e){var t=e.certType,a=void 0===t?0:t,n=e.order,c=e.stepGid,i=e.userIp;e.timestamp;try{window.hrdFrame.hideKeyPad()}catch(d){}try{var s=F.otpVal||k.current.value;if(null==s||""==s)return alert("otp \ubc88\ud638\ub97c \uc785\ub825\ud558\uc5ec \uc8fc\uc2ed\uc2dc\uc624."),!1;var u=window.hrdFrame.getUT();S.a.ajax({type:"POST",url:"https://fds.hrdkorea.or.kr/fdsService/hrdOTP/JSP/validateOtp/chkOtpResult.jsp",crossDomain:!0,data:{AGTID:R.current,USRID:y.current,SESSIONID:I.current,OTPNO:s,COURSE_AGENT_PK:A.current,CLASS_AGENT_PK:j.current,EVAL_CD:"01",EVAL_TYPE:"\uc9c4\ub3c4",CLASS_TME:D.current,UT:u},dataType:"xml",success:function(e){if(console.log("success:",e),"101"===S()(e).find("RetVal").text())window.hideKeypad(),l({certType:a,order:n,stepGid:c,userIp:i,timestamp:new Date(u).getTime()/1e3,certNumber:s,isCert:!0,sortation:n%8===0?n:1})&&(P.d.includes(D.current)&&localStorage.setItem("CERT_LAST_TME",D.current),T(!0),r(!0),O(),alert("OTP \uc778\uc99d\uc774 \uc131\uacf5\uc801\uc73c\ub85c \uc774\ub8e8\uc5b4\uc84c\uc2b5\ub2c8\ub2e4."));else if("102"===S()(e).find("RetVal").text()){window.hideKeypad(),parseInt(S()(e).find("ErrCnt").text())>=5&&(M(Object(o.a)(Object(o.a)({},F),{},{OTP_STATUS:"102"})),C({otpStatus:"102",stepGid:c}),console.log("OTP 5\ud68c \uc5f0\uc18d \uc624\ub958!!"));l({certType:a,order:n,stepGid:c,userIp:i,timestamp:new Date(u).getTime()/1e3,certNumber:s,isCert:!1,sortation:n%8===0?n:1});window.ExecuteOTP()}},error:function(e,t,r){console.log("error:",e,t,r);try{window.hideKeypad()}catch(d){}}})}catch(d){console.log("certCatchError::",d);try{window.hideKeypad()}catch(d){}}}({certType:parseInt(N.current),order:parseInt(D.current),stepGid:x.current,userIp:L.current})}})," ",u.a.createElement("input",{type:"button",value:"RESET",size:"sm",className:"button",onClick:function(){V()}}))),u.a.createElement(d.a.Footer,{className:"p-0 text-center"},F.isLoading&&u.a.createElement("div",null,u.a.createElement(m.a,{isNotFixed:!0})),u.a.createElement("div",{className:"cert-body w-100 text-center"},u.a.createElement("div",{id:"hrdOtpFrame",ref:G,className:"cert-body-top w-100 text-center"},"\xa0"),u.a.createElement("div",{className:"cert-body-footer text-left"},"\u203b \uc778\uc99d\uc11c \uc120\ud0dd\uc2dc \ud074\ub77c\uc6b0\ub4dc OTP\ub97c \uc120\ud0dd\ud574 \uc8fc\uc138\uc694"))))}))}}]);